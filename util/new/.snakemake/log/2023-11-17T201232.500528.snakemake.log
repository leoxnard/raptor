Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job           count
----------  -------
result            1
run_raptor        4
total             5

Select jobs to execute...

[Fri Nov 17 20:12:34 2023]
rule run_raptor:
    input: raptor_binary_checked, output_checked, input_file_8192_checked
    output: /srv/data/leonard/test_run/8192_raptor_run
    jobid: 9
    reason: Missing output files: /srv/data/leonard/test_run/8192_raptor_run
    wildcards: bin_count=8192
    resources: tmpdir=/tmp

RuleException in rule run_raptor in file /srv/public/leonard/raptor/util/new/Snakefile, line 58:
NameError: The name 'RAPTOR_BINARY' is unknown in this context. Please make sure that you defined that variable. Also note that braces not used for variable access have to be escaped by repeating them, i.e. {{print $1}}, when formatting the following:

        echo "[$(date +"%Y-%m-%d %T")] Running raptor layout for {wildcards.bin_count} bins."
        # Raptor layout doesn't provide `--timing-output`, so we use /usr/bin/time with a custom format
        /usr/bin/time -o {params.LAYOUT_TIME} -f "wall_clock_time_in_seconds	peak_memory_usage_in_kibibytes
%e	%M"         ${RAPTOR_BINARY} layout --input {params.INPUT_DIR}/{wildcards.bin_count}.filenames                                 --output {params.LAYOUT_FILE}                                 --kmer {params.KMER_SIZE}                                 --fpr {params.MAXIMUM_FPR}                                 --relaxed-fpr {params.RELAXED_FPR}                                 --hash {params.NUM_HASHES}                                 --disable-estimate-union                                 --disable-rearrangement                                 --threads {params.NUM_THREADS}

        echo "[$(date +"%Y-%m-%d %T")] Running raptor build for {wildcards.bin_count} bins."
        ${RAPTOR_BINARY} build  --input {params.LAYOUT_FILE}                                 --output {params.INDEX_FILE}                                 --window params.{WINDOW_SIZE}                                 --quiet                                 --timing-output {params.INDEX_TIME}                                 --threads {params.NUM_THREADS}

        echo "[$(date +"%Y-%m-%d %T")] Running raptor search for {wildcards.bin_count} bins."
        ${RAPTOR_BINARY} search --index {params.INDEX_FILE}                                 --query {params.INPUT_DIR}/{wildcards.bin_count}/reads_e${QUERY_ERRORS}_${QUERY_LENGTH}/all.fastq                                 --output {params.RESULT_FILE}                                 --error {params.QUERY_ERRORS}                                 --query_length {params.QUERY_LENGTH}                                 --quiet                                 --timing-output {params.RESULT_TIME}                                 --threads {params.NUM_THREADS}
        
